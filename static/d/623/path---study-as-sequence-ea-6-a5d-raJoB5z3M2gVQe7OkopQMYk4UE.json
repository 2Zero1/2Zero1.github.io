{"data":{"site":{"siteMetadata":{"title":"Zero1's Note","author":"Zero1","siteUrl":"https://github.com/2Zero1","comment":{"disqusShortName":"2Zero1","utterances":"2Zero1 Blog"},"sponsor":{"buyMeACoffeeId":"jbee"}}},"markdownRemark":{"id":"de76a0c4-c204-5e84-bcf8-fc5ace9d59e4","excerpt":"asSequence 의 특징 1. kotlin 에서 iterable을 상속한 모든 객체는 asSequence 메소드를 사용하여 sequence 형태로 변할 수 있다. 밑의 signature는 asSequence가 Iterable < T>의 확장함수로 정의되어져 있는것을 볼 수 있다 2. 자바에서 Stream 제공한다면 쓴다면 kotlin은 Sequence를 제공하고 거의 동일한 기능을 수행한다 3. 공통점 실행하거나 최종 연산을 하기 전까지 연산을 지연하여 함수형태로 갖는다. map, filter…","html":"<h2 id=\"assequence-의-특징\"><a href=\"#assequence-%EC%9D%98-%ED%8A%B9%EC%A7%95\" aria-label=\"assequence 의 특징 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>asSequence 의 특징</h2>\n<h3 id=\"1-kotlin-에서-iterable을-상속한-모든-객체는-assequence-메소드를-사용하여-sequence-형태로-변할-수-있다-밑의-signature는-assequence가-iterablet의-확장함수로-정의되어져-있는것을-볼-수-있다\"><a href=\"#1-kotlin-%EC%97%90%EC%84%9C-iterable%EC%9D%84-%EC%83%81%EC%86%8D%ED%95%9C-%EB%AA%A8%EB%93%A0-%EA%B0%9D%EC%B2%B4%EB%8A%94-assequence-%EB%A9%94%EC%86%8C%EB%93%9C%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-sequence-%ED%98%95%ED%83%9C%EB%A1%9C-%EB%B3%80%ED%95%A0-%EC%88%98-%EC%9E%88%EB%8B%A4-%EB%B0%91%EC%9D%98-signature%EB%8A%94-assequence%EA%B0%80-iterablet%EC%9D%98-%ED%99%95%EC%9E%A5%ED%95%A8%EC%88%98%EB%A1%9C-%EC%A0%95%EC%9D%98%EB%90%98%EC%96%B4%EC%A0%B8-%EC%9E%88%EB%8A%94%EA%B2%83%EC%9D%84-%EB%B3%BC-%EC%88%98-%EC%9E%88%EB%8B%A4\" aria-label=\"1 kotlin 에서 iterable을 상속한 모든 객체는 assequence 메소드를 사용하여 sequence 형태로 변할 수 있다 밑의 signature는 assequence가 iterablet의 확장함수로 정의되어져 있는것을 볼 수 있다 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. kotlin 에서 iterable을 상속한 모든 객체는 asSequence 메소드를 사용하여 sequence 형태로 변할 수 있다. 밑의 signature는 asSequence가 Iterable&#x3C;T>의 확장함수로 정의되어져 있는것을 볼 수 있다</h3>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">fun</span> <span class=\"token operator\">&lt;</span>T<span class=\"token operator\">></span> Iterable<span class=\"token operator\">&lt;</span>T<span class=\"token operator\">></span><span class=\"token punctuation\">.</span><span class=\"token function\">asSequence</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Sequence<span class=\"token operator\">&lt;</span>T<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> Sequence <span class=\"token punctuation\">{</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">iterator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"2-자바에서-stream-제공한다면-쓴다면-kotlin은-sequence를-제공하고-거의-동일한-기능을-수행한다\"><a href=\"#2-%EC%9E%90%EB%B0%94%EC%97%90%EC%84%9C-stream-%EC%A0%9C%EA%B3%B5%ED%95%9C%EB%8B%A4%EB%A9%B4-%EC%93%B4%EB%8B%A4%EB%A9%B4-kotlin%EC%9D%80-sequence%EB%A5%BC-%EC%A0%9C%EA%B3%B5%ED%95%98%EA%B3%A0-%EA%B1%B0%EC%9D%98-%EB%8F%99%EC%9D%BC%ED%95%9C-%EA%B8%B0%EB%8A%A5%EC%9D%84-%EC%88%98%ED%96%89%ED%95%9C%EB%8B%A4\" aria-label=\"2 자바에서 stream 제공한다면 쓴다면 kotlin은 sequence를 제공하고 거의 동일한 기능을 수행한다 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 자바에서 Stream 제공한다면 쓴다면 kotlin은 Sequence를 제공하고 거의 동일한 기능을 수행한다</h3>\n<h3 id=\"3-공통점\"><a href=\"#3-%EA%B3%B5%ED%86%B5%EC%A0%90\" aria-label=\"3 공통점 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 공통점</h3>\n<ol>\n<li>실행하거나 최종 연산을 하기 전까지 연산을 지연하여 함수형태로 갖는다.</li>\n<li>map, filter 등과 같은 함수형 인터페이스를 사용할 수 있다.(함수형 인터페이스 찾아보기)</li>\n</ol>\n<h4 id=\"차이점\"><a href=\"#%EC%B0%A8%EC%9D%B4%EC%A0%90\" aria-label=\"차이점 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>차이점</h4>\n<h5 id=\"제공하는-메소드가-다르다\"><a href=\"#%EC%A0%9C%EA%B3%B5%ED%95%98%EB%8A%94-%EB%A9%94%EC%86%8C%EB%93%9C%EA%B0%80-%EB%8B%A4%EB%A5%B4%EB%8B%A4\" aria-label=\"제공하는 메소드가 다르다 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>제공하는 메소드가 다르다</h5>\n<h5 id=\"java의-stream은-한번-수행-하고-나면-stream이-닫히게-되어-재생성-해야되는-반면-sequence는-다시-실행할-수-있다\"><a href=\"#java%EC%9D%98-stream%EC%9D%80-%ED%95%9C%EB%B2%88-%EC%88%98%ED%96%89-%ED%95%98%EA%B3%A0-%EB%82%98%EB%A9%B4-stream%EC%9D%B4-%EB%8B%AB%ED%9E%88%EA%B2%8C-%EB%90%98%EC%96%B4-%EC%9E%AC%EC%83%9D%EC%84%B1-%ED%95%B4%EC%95%BC%EB%90%98%EB%8A%94-%EB%B0%98%EB%A9%B4-sequence%EB%8A%94-%EB%8B%A4%EC%8B%9C-%EC%8B%A4%ED%96%89%ED%95%A0-%EC%88%98-%EC%9E%88%EB%8B%A4\" aria-label=\"java의 stream은 한번 수행 하고 나면 stream이 닫히게 되어 재생성 해야되는 반면 sequence는 다시 실행할 수 있다 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>java의 stream은 한번 수행 하고 나면 stream이 닫히게 되어 재생성 해야되는 반면 sequence는 다시 실행할 수 있다</h5>\n<h5 id=\"kotlin에서-제공되는-stream을-사용할-경우-sum-fold-메소드를-사용하기-위해선-프리미티브-스트림형태로-변형해서-사용해야되는-반면-sequence는-바로-사용할-수-있다-근데-왜-안될까-\"><a href=\"#kotlin%EC%97%90%EC%84%9C-%EC%A0%9C%EA%B3%B5%EB%90%98%EB%8A%94-stream%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%A0-%EA%B2%BD%EC%9A%B0-sum-fold-%EB%A9%94%EC%86%8C%EB%93%9C%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0-%EC%9C%84%ED%95%B4%EC%84%A0-%ED%94%84%EB%A6%AC%EB%AF%B8%ED%8B%B0%EB%B8%8C-%EC%8A%A4%ED%8A%B8%EB%A6%BC%ED%98%95%ED%83%9C%EB%A1%9C-%EB%B3%80%ED%98%95%ED%95%B4%EC%84%9C-%EC%82%AC%EC%9A%A9%ED%95%B4%EC%95%BC%EB%90%98%EB%8A%94-%EB%B0%98%EB%A9%B4-sequence%EB%8A%94-%EB%B0%94%EB%A1%9C-%EC%82%AC%EC%9A%A9%ED%95%A0-%EC%88%98-%EC%9E%88%EB%8B%A4-%EA%B7%BC%EB%8D%B0-%EC%99%9C-%EC%95%88%EB%90%A0%EA%B9%8C-\" aria-label=\"kotlin에서 제공되는 stream을 사용할 경우 sum fold 메소드를 사용하기 위해선 프리미티브 스트림형태로 변형해서 사용해야되는 반면 sequence는 바로 사용할 수 있다 근데 왜 안될까  permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>kotlin에서 제공되는 stream을 사용할 경우, sum, fold 메소드를 사용하기 위해선 프리미티브 스트림형태로 변형해서 사용해야되는 반면, sequence는 바로 사용할 수 있다. (근데 왜 안될까 ?)</h5>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\">    <span class=\"token keyword\">val</span> stream <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">..</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">asSequence</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">asStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    stream<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">{</span>acc<span class=\"token punctuation\">,</span> s <span class=\"token operator\">-></span> acc<span class=\"token operator\">+</span>s<span class=\"token punctuation\">}</span><span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    stream<span class=\"token punctuation\">.</span><span class=\"token function\">fold</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>acc<span class=\"token punctuation\">,</span>s <span class=\"token operator\">-></span> acc<span class=\"token operator\">+</span>s<span class=\"token punctuation\">}</span>  <span class=\"token comment\">//안된다.</span></code></pre></div>\n<h3 id=\"4-assequence는-최종연산-메소드가-실행되기-전까지-연산을-지연한다\"><a href=\"#4-assequence%EB%8A%94-%EC%B5%9C%EC%A2%85%EC%97%B0%EC%82%B0-%EB%A9%94%EC%86%8C%EB%93%9C%EA%B0%80-%EC%8B%A4%ED%96%89%EB%90%98%EA%B8%B0-%EC%A0%84%EA%B9%8C%EC%A7%80-%EC%97%B0%EC%82%B0%EC%9D%84-%EC%A7%80%EC%97%B0%ED%95%9C%EB%8B%A4\" aria-label=\"4 assequence는 최종연산 메소드가 실행되기 전까지 연산을 지연한다 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. asSequence는 최종연산 메소드가 실행되기 전까지 연산을 지연한다</h3>\n<h4 id=\"collection를-사용하여-메소드를-chainning-할-경우\"><a href=\"#collection%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-%EB%A9%94%EC%86%8C%EB%93%9C%EB%A5%BC-chainning-%ED%95%A0-%EA%B2%BD%EC%9A%B0\" aria-label=\"collection를 사용하여 메소드를 chainning 할 경우 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>collection를 사용하여 메소드를 chainning 할 경우</h4>\n<p>설명 : [1,2,3,4,5]를 filter 메소드를 2번 사용하고, map을 하는 코드이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\">  <span class=\"token keyword\">val</span> collection <span class=\"token operator\">=</span> <span class=\"token function\">intArrayOf</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">filter</span> <span class=\"token punctuation\">{</span> it <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">!=</span><span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">.</span><span class=\"token function\">filter</span> <span class=\"token punctuation\">{</span> it <span class=\"token operator\">%</span> <span class=\"token number\">1</span> <span class=\"token operator\">==</span><span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span> <span class=\"token punctuation\">{</span> it <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p>밑의 자바코드는 위의 코틀린 코드를 decompiling 한 것이다.</p>\n<p>map 하기 전의 두번의 filter를 하고 2번의 임시 collection을 만들고 있다.\n[1,2,3,4,5] 에서 홀수인 것만 filter를 한 결과값 [1, 3, 5]에 다시 1로 나누어떨어지는 수를 filter하여 [1, 3, 5] 란 결과값을 얻었고, 그것을 다시 연산 +1 을 하여 결과값 [2, 4, 6]을 만들어 내고 있다. 이 과정에서 loop 문은 총 11번 실행한 것을 확인할 수 있다. </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TestKt</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">int</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> $<span class=\"token keyword\">this</span>$filter$iv <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">int</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">int</span> $i$f$map <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n      Collection destination$iv$iv <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Collection<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">int</span> $i$f$mapTo <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">int</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> var6 <span class=\"token operator\">=</span> $<span class=\"token keyword\">this</span>$filter$iv<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">int</span> var7 <span class=\"token operator\">=</span> $<span class=\"token keyword\">this</span>$filter$iv<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">int</span> it<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>it <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> it <span class=\"token operator\">&lt;</span> var7<span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>it<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n         <span class=\"token keyword\">int</span> element$iv$iv <span class=\"token operator\">=</span> var6<span class=\"token punctuation\">[</span>it<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n         <span class=\"token keyword\">int</span> var11 <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>element$iv$iv <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            destination$iv$iv<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>element$iv$iv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n         <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n\n      Iterable $<span class=\"token keyword\">this</span>$map$iv <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Iterable<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>List<span class=\"token punctuation\">)</span>destination$iv$iv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      $i$f$map <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n      destination$iv$iv <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Collection<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      $i$f$mapTo <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n      Iterator var15 <span class=\"token operator\">=</span> $<span class=\"token keyword\">this</span>$map$iv<span class=\"token punctuation\">.</span><span class=\"token function\">iterator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      Object item$iv$iv<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">boolean</span> var17<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>var15<span class=\"token punctuation\">.</span><span class=\"token function\">hasNext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n         item$iv$iv <span class=\"token operator\">=</span> var15<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n         it <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>Number<span class=\"token punctuation\">)</span>item$iv$iv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">intValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n         var17 <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n         <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>it <span class=\"token operator\">%</span> <span class=\"token number\">1</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            destination$iv$iv<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>item$iv$iv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n         <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n\n      $<span class=\"token keyword\">this</span>$map$iv <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Iterable<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>List<span class=\"token punctuation\">)</span>destination$iv$iv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      $i$f$map <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n      destination$iv$iv <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Collection<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token punctuation\">(</span>CollectionsKt<span class=\"token punctuation\">.</span><span class=\"token function\">collectionSizeOrDefault</span><span class=\"token punctuation\">(</span>$<span class=\"token keyword\">this</span>$map$iv<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      $i$f$mapTo <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n      var15 <span class=\"token operator\">=</span> $<span class=\"token keyword\">this</span>$map$iv<span class=\"token punctuation\">.</span><span class=\"token function\">iterator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>var15<span class=\"token punctuation\">.</span><span class=\"token function\">hasNext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n         item$iv$iv <span class=\"token operator\">=</span> var15<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n         it <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>Number<span class=\"token punctuation\">)</span>item$iv$iv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">intValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n         var17 <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n         Integer var13 <span class=\"token operator\">=</span> it <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n         destination$iv$iv<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>var13<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      List sequence <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>List<span class=\"token punctuation\">)</span>destination$iv$iv<span class=\"token punctuation\">;</span>\n   <span class=\"token punctuation\">}</span>\n\n   <span class=\"token comment\">// $FF: synthetic method</span>\n   <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> var0<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4 id=\"sequence를-사용하여-메소드를-chainning-할-경우\"><a href=\"#sequence%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-%EB%A9%94%EC%86%8C%EB%93%9C%EB%A5%BC-chainning-%ED%95%A0-%EA%B2%BD%EC%9A%B0\" aria-label=\"sequence를 사용하여 메소드를 chainning 할 경우 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sequence를 사용하여 메소드를 chainning 할 경우</h4>\n<p>asSequence를 사용할 경우, 실제로 5번의 루프를 실행하고 종료가 될것이다. 그 이유는 sequence가 filter와 map 을 사용하여 함수로써 갖고 있고, 실행하기 전까지는 함수가 실행이 되지 않기 때문이다. 최종 연산을 할때 연산을 한 후의 값을 갖게 된다. 이 방식은 함수형 프로그래밍에서 사용하는 방식으로(실제로 함수형에선 어떻게 구현되어지는지 아직은 모른다.), 객체지향언어인 코틀린에서는 실제로 구현 코드는 저런 형태로 실행되도록 구현되어져 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\">    <span class=\"token keyword\">val</span> sequence <span class=\"token operator\">=</span> <span class=\"token function\">intArrayOf</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">asSequence</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">filter</span> <span class=\"token punctuation\">{</span> it <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">!=</span><span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">.</span><span class=\"token function\">filter</span> <span class=\"token punctuation\">{</span> it <span class=\"token operator\">%</span> <span class=\"token number\">1</span> <span class=\"token operator\">==</span><span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span> <span class=\"token punctuation\">{</span> it <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"5-그렇다면-위에서-이야기한-sequence가-각각-함수를-갖고-지연-실행을-어떻게-구현하고-있는지-살펴보자\"><a href=\"#5-%EA%B7%B8%EB%A0%87%EB%8B%A4%EB%A9%B4-%EC%9C%84%EC%97%90%EC%84%9C-%EC%9D%B4%EC%95%BC%EA%B8%B0%ED%95%9C-sequence%EA%B0%80-%EA%B0%81%EA%B0%81-%ED%95%A8%EC%88%98%EB%A5%BC-%EA%B0%96%EA%B3%A0-%EC%A7%80%EC%97%B0-%EC%8B%A4%ED%96%89%EC%9D%84-%EC%96%B4%EB%96%BB%EA%B2%8C-%EA%B5%AC%ED%98%84%ED%95%98%EA%B3%A0-%EC%9E%88%EB%8A%94%EC%A7%80-%EC%82%B4%ED%8E%B4%EB%B3%B4%EC%9E%90\" aria-label=\"5 그렇다면 위에서 이야기한 sequence가 각각 함수를 갖고 지연 실행을 어떻게 구현하고 있는지 살펴보자 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. 그렇다면 위에서 이야기한 sequence가 각각 함수를 갖고 지연 실행을 어떻게 구현하고 있는지 살펴보자.</h3>\n<p>밑의 자바코드 또한 위의 코틀린 코드를 decompiling을 한 코드이다.\n위에서 사용한 filter와 map은 밑에서 SequencesKt.filter와 SequencesKt.map으로 실행 되고 있고, 맨 처음에 SequencesKt.filter() 를 보면 시퀀스 배열 ArraysKt.asSequence(new int[]{1, 2, 3, 4, 5})과 필터에서 사용될 람다( (Function1)null.INSTANCE)를 파라미터로 넣고있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TestKt</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      Sequence sequence <span class=\"token operator\">=</span> SequencesKt<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>SequencesKt<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>SequencesKt<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>ArraysKt<span class=\"token punctuation\">.</span><span class=\"token function\">asSequence</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">int</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>Function1<span class=\"token punctuation\">)</span>null<span class=\"token punctuation\">.</span>INSTANCE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>Function1<span class=\"token punctuation\">)</span>null<span class=\"token punctuation\">.</span>INSTANCE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>Function1<span class=\"token punctuation\">)</span>null<span class=\"token punctuation\">.</span>INSTANCE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token punctuation\">}</span>\n\n   <span class=\"token comment\">// $FF: synthetic method</span>\n   <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> var0<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위에서 filter의 내부를 보면 밑의 코드와 같이 받는다. 인자값으로 sequence = ArraysKt.asSequence(new int[]{1, 2, 3, 4, 5})와 predicate SequencesKt.filter()를 받고 있다. 그리고 Sequence를 상속하여 iterator과 내부 인터페이스를 구현하고 있다. iterator 메소드 안에서 iterator는 인자값으로 받은 sequence로 itertor를 만들고 있다. calcNext는 조건에 맞는지 확인해 주며 next에서 조건에 맞으면 반환하고 있다(return을 사용하여 루프를 끊어주고 있음.). 조건에 맞지 않다면 바로 넘어간다.(return에 걸리지 않음.)</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">internal <span class=\"token keyword\">class</span> <span class=\"token class-name\">FilteringSequence</span><span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>T<span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">private</span> val sequence<span class=\"token operator\">:</span> Sequence<span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>T<span class=\"token punctuation\">></span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token keyword\">private</span> val sendWhen<span class=\"token operator\">:</span> Boolean <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n        <span class=\"token keyword\">private</span> val predicate<span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>T<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> Boolean\n    <span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> Sequence<span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>T<span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n\n        override fun <span class=\"token function\">iterator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Iterator<span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>T<span class=\"token punctuation\">></span></span> <span class=\"token operator\">=</span> object <span class=\"token operator\">:</span> Iterator<span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>T<span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n            val iterator <span class=\"token operator\">=</span> sequence<span class=\"token punctuation\">.</span><span class=\"token function\">iterator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            var nextState<span class=\"token operator\">:</span> Int <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token comment\">// -1 for unknown, 0 for done, 1 for continue</span>\n            var nextItem<span class=\"token operator\">:</span> T<span class=\"token operator\">?</span> <span class=\"token operator\">=</span> null\n\n            <span class=\"token keyword\">private</span> fun <span class=\"token function\">calcNext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>iterator<span class=\"token punctuation\">.</span><span class=\"token function\">hasNext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    val item <span class=\"token operator\">=</span> iterator<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">predicate</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> sendWhen<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                        nextItem <span class=\"token operator\">=</span> item\n                        nextState <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n                        <span class=\"token keyword\">return</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span>\n                nextState <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n            <span class=\"token punctuation\">}</span>\n\n            override fun <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> T <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>nextState <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token function\">calcNext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>nextState <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token keyword\">throw</span> <span class=\"token function\">NoSuchElementException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  \n                val result <span class=\"token operator\">=</span> nextItem\n                nextItem <span class=\"token operator\">=</span> null\n                nextState <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\n                <span class=\"token annotation punctuation\">@Suppress</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"UNCHECKED_CAST\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">return</span> result as T\n            <span class=\"token punctuation\">}</span>\n\n            override fun <span class=\"token function\">hasNext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Boolean <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>nextState <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token function\">calcNext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">return</span> nextState <span class=\"token operator\">==</span> <span class=\"token number\">1</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<p>map은 java코드로 아래와 같은 코드로 구현되어져 있고 이것도 위와 유사하게 Sequence를 상속받아 iterator를 구현하고 있다. 인자값으로는 sequence를 FilteringSequence : Sequence 타입 인자값으로 받는다. 그리고 transformer라는 람다를 받고 있다. 이곳에서의 iterator 메소드 안에서는 우리가 인자값으로 받은 sequence(FilteringSequence타입)를 사용하여 itertor()메소드를 사용하고 있다. next에서는 인자값 sequence로부터 만든 iterator 메소드로 만든 iterator(FilteringSequence타입)의 next()를 구현한다. next()는 위에서 만든 방식으로 실행이 될것이고, 인자로 받은 람다의 인자값으로 next()로 얻은 값을 넣어 수행할 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"> internal <span class=\"token keyword\">class</span> <span class=\"token class-name\">TransformingSequence</span><span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>T<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">></span></span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">private</span> val sequence<span class=\"token operator\">:</span> Sequence<span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>T<span class=\"token punctuation\">></span></span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">private</span> val transformer<span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>T<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> R<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> Sequence<span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>R<span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n        override fun <span class=\"token function\">iterator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Iterator<span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>R<span class=\"token punctuation\">></span></span> <span class=\"token operator\">=</span> object <span class=\"token operator\">:</span> Iterator<span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>R<span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n            val iterator <span class=\"token operator\">=</span> sequence<span class=\"token punctuation\">.</span><span class=\"token function\">iterator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            override fun <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> R <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">return</span> <span class=\"token function\">transformer</span><span class=\"token punctuation\">(</span>iterator<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n\n            override fun <span class=\"token function\">hasNext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Boolean <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">return</span> iterator<span class=\"token punctuation\">.</span><span class=\"token function\">hasNext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n        internal fun <span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>E<span class=\"token punctuation\">></span></span> <span class=\"token function\">flatten</span><span class=\"token punctuation\">(</span>iterator<span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> Iterator<span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>E<span class=\"token punctuation\">></span></span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Sequence<span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>E<span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> FlatteningSequence<span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>T<span class=\"token punctuation\">,</span> R<span class=\"token punctuation\">,</span> E<span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>sequence<span class=\"token punctuation\">,</span> transformer<span class=\"token punctuation\">,</span> iterator<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<p>asSequence를 사용하여 메서드를 channing 하는 방식이 위와같은 방법으로 구현되어져 있고,</p>\n<p>Sequence를 사용하여 여러 함수형 인터페이스를 사용한다면 임시 컬렉션을 사용하여 11번의 루프를 실행하는 것이 아니라, 각 배열의 원소를 인자값으로 함수들이 겹겹이 쌓여진 형태로 하나씩 진행되기 때문에 5회의 루프만으로 진행할 수 있게 된다.</p>\n<p>내가 보면서 발견한 것은 위의 방법에는 데코레이션 패턴이 적용되어져 있다는 것이다. 매번 자신과 같은 타입을 인자값(위에서는 sequence)으로 넘기고, 각각들이 동일한 인터페이스를 다르게 구현하며, 메소드의 실행이 데코레이션에 들어간 각각의 객체들에게 채이닝 되는 현상을 볼 수 있었다.</p>","frontmatter":{"title":"Kotlin의 asSequence","date":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/study/asSequence/","previous":{"fields":{"slug":"/til/2020-02-21/"},"frontmatter":{"title":"2020-02-21 TIL","category":"TIL"}},"next":{"fields":{"slug":"/study/booklist/"},"frontmatter":{"title":"Book List","category":"BookList"}}}}